<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title th:text="${app != null ? app.name + ' - App Monitor Details' : 'App Monitor Details'}">App Monitor
        Details</title>
    <link rel="icon" type="image/x-icon" href="/img/favicon.png">
    <!-- CSS files -->
    <link href="/dist/css/tabler.min.css?1692870487" rel="stylesheet"/>
    <link href="/dist/css/tabler-flags.min.css?1692870487" rel="stylesheet"/>
    <link href="/dist/css/tabler-payments.min.css?1692870487" rel="stylesheet"/>
    <link href="/dist/css/tabler-vendors.min.css?1692870487" rel="stylesheet"/>
    <link href="/dist/css/demo.min.css?1692870487" rel="stylesheet"/>
    <link href="/style.css" rel="stylesheet"/>
    <style>
        @import url('https://rsms.me/inter/inter.css');

        :root {
            --tblr-font-sans-serif: 'Inter Var', -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif;
        }

        body {
            font-feature-settings: "cv03", "cv04", "cv11";
        }

        .status-indicator-animated {
            display: inline-block;
            position: relative;
            width: 12px;
            height: 12px;
            margin-right: 8px;
            vertical-align: middle;
        }

        .status-indicator-animated .status-indicator-circle {
            position: absolute;
            top: 0;
            left: 0;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: status-indicator-pulse 2s infinite;
        }

        .status-indicator-animated .status-indicator-circle:nth-child(1) {
            animation-delay: 0s;
        }

        .status-indicator-animated .status-indicator-circle:nth-child(2) {
            animation-delay: 0.3s;
        }

        .status-indicator-animated .status-indicator-circle:nth-child(3) {
            animation-delay: 0.6s;
        }

        .status-red .status-indicator-circle {
            background-color: #b80505;
        }

        .status-green .status-indicator-circle {
            background-color: #2fb344;
        }

        @keyframes status-indicator-pulse {
            0% {
                opacity: 0.8;
                transform: scale(1);
            }

            50% {
                opacity: 0.4;
                transform: scale(1.1);
            }

            100% {
                opacity: 0.8;
                transform: scale(1);
            }
        }

        .uptime-chart {
            height: 80px;
            display: flex;
            align-items: end;
            gap: 3px;
            overflow-x: auto;
            padding: 8px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .uptime-bar {
            width: 4px;
            min-width: 4px;
            background-color: #ced4da;
            border-radius: 2px;
            transition: all 0.3s ease;
            flex-shrink: 0;
            position: relative;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .uptime-bar:hover {
            transform: scaleY(1.1);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
        }

        .uptime-bar.up {
            background: linear-gradient(180deg, #48c774 0%, #2fb344 100%);
            box-shadow: 0 1px 3px rgba(47, 179, 68, 0.3);
        }

        .uptime-bar.down {
            background: linear-gradient(180deg, #ff6b6b 0%, #b80505 100%);
            box-shadow: 0 1px 3px rgba(184, 5, 5, 0.3);
        }

        .uptime-bar.up:hover {
            box-shadow: 0 2px 6px rgba(47, 179, 68, 0.4);
        }

        .uptime-bar.down:hover {
            box-shadow: 0 2px 6px rgba(184, 5, 5, 0.4);
        }

        .badge {
            color: white;
        }
    </style>
</head>
<body>
<script src="/dist/js/demo-theme.min.js?1692870487"></script>

<div class="page">
    <!-- Navbar -->
    <header class="navbar navbar-expand-md d-print-none">
        <div class="container-xl">
            <h1 class="navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3">
                <a href="/" th:text="${appName}">Server Monitor</a>
            </h1>
            <div class="navbar-nav flex-row order-md-last">
                <div class="d-none d-md-flex">
                    <a href="?theme=dark" class="nav-link px-0 hide-theme-dark" title="Enable dark mode"
                       data-bs-toggle="tooltip"
                       data-bs-placement="bottom">
                        <!-- Download SVG icon from http://tabler-icons.io/i/moon -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24"
                             stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                             stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"/>
                        </svg>
                    </a>
                    <a href="?theme=light" class="nav-link px-0 hide-theme-light" title="Enable light mode"
                       data-bs-toggle="tooltip"
                       data-bs-placement="bottom">
                        <!-- Download SVG icon from http://tabler-icons.io/i/sun -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24"
                             stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                             stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"/>
                            <path d="M3 12h1m8 -9v1m8 8h1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"/>
                        </svg>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="/" class="btn btn-outline-primary">‚Üê Back to Dashboard</a>
                </div>
            </div>
        </div>
    </header>

    <div class="page-wrapper">
        <!-- Page header -->
        <div class="page-header d-print-none">
            <div class="container-xl">
                <div class="row g-2 align-items-center">
                    <div class="col">
                        <h2 class="page-title">
                            <span class="status-indicator-animated"
                                  th:classappend="${isCurrentlyUp ? 'status-green' : 'status-red'}">
                                <span class="status-indicator-circle"></span>
                                <span class="status-indicator-circle"></span>
                                <span class="status-indicator-circle"></span>
                            </span>
                            <span th:text="${app != null ? app.name : 'App Monitor'}">App Monitor</span>
                        </h2>
                        <div class="page-subtitle"
                             th:text="${app != null ? app.description : 'Application monitoring details'}">Application
                            monitoring details
                        </div>
                    </div>
                    <div class="col-auto ms-auto">
                        <div class="btn-list">
                            <span th:class="${isCurrentlyUp ? 'badge bg-success' : 'badge bg-danger'}"
                                  th:text="${statusBadge}">Online</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Page body -->
        <div class="page-body">
            <div class="container-xl">
                <div class="row row-deck row-cards">
                    <!-- Current Status Card -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Current Status</h3>
                                <div class="card-actions">
                                    <small class="text-muted" th:text="'Last updated: ' + ${lastUpdated}">Last updated:
                                        Now</small>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">Application URL</label>
                                            <div>
                                                <a th:if="${app != null and app.link != null}" th:href="${app.link}"
                                                   th:text="${app.url}" target="_blank" class="text-primary">N/A</a>
                                                <span th:unless="${app != null and app.url != null}" class="text-muted">N/A</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="mb-3">
                                            <label class="form-label">Process Running</label>
                                            <div>
                                                <span class="badge bg-success"
                                                      th:if="${currentStatus != null and currentStatus.isRunning}">Yes</span>
                                                <span class="badge bg-danger"
                                                      th:unless="${currentStatus != null and currentStatus.isRunning}">No</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">HTTP Reachable</label>
                                            <div>
                                                <span class="badge bg-success"
                                                      th:if="${currentStatus != null and currentStatus.isHttpReachable == true}">Yes</span>
                                                <span class="badge bg-danger"
                                                      th:if="${currentStatus != null and currentStatus.isHttpReachable == false}">No</span>
                                                <span class="badge bg-secondary"
                                                      th:if="${currentStatus == null or currentStatus.isHttpReachable == null}">N/A</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">HTTPS Reachable</label>
                                            <div>
                                                <span class="badge bg-success"
                                                      th:if="${currentStatus != null and currentStatus.isHttpsReachable == true}">Yes</span>
                                                <span class="badge bg-danger"
                                                      th:if="${currentStatus != null and currentStatus.isHttpsReachable == false}">No</span>
                                                <span class="badge bg-secondary"
                                                      th:if="${currentStatus == null or currentStatus.isHttpsReachable == null}">N/A</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Uptime Statistics Card -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Uptime Statistics</h3>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Uptime Percentage</label>
                                            <div class="h2 mb-0" th:text="${uptimePercentage + '%'}">0%</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Total Checks</label>
                                            <div class="h3 mb-0" th:text="${totalEntries}">0</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Successful Checks</label>
                                            <div class="h3 mb-0 text-success" th:text="${upEntries}">0</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Failed Checks</label>
                                            <div class="h3 mb-0 text-danger" th:text="${totalEntries - upEntries}">0
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Availability History Card -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Availability History</h3>
                                <div class="card-actions">
                                    <small class="text-muted">Green = Up, Red = Down</small>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="uptime-chart">
                                    <div th:each="entry : ${history}"
                                         class="uptime-bar"
                                         th:class="${entry.isUp ? 'uptime-bar up' : 'uptime-bar down'}"
                                         th:title="${entry.time + ' - ' + (entry.isUp ? 'Up' : 'Down')}"
                                         style="height: 100%;">
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <small class="text-muted">Most recent entries are on the right</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Events Table -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Recent Events (Database Changes)</h3>
                                <div class="card-actions">
                                    <small class="text-muted">Shows actual status changes as stored in database</small>
                                </div>
                            </div>
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-vcenter card-table">
                                        <thead>
                                        <tr>
                                            <th>Time</th>
                                            <th>Status</th>
                                            <th>Process</th>
                                            <th>HTTP</th>
                                            <th>HTTPS</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr th:each="entry : ${rawHistory}">
                                            <td th:text="${entry.time}">Time</td>
                                            <td>
                                                <span class="badge bg-success" th:if="${entry.isUp}">Up</span>
                                                <span class="badge bg-danger" th:unless="${entry.isUp}">Down</span>
                                            </td>
                                            <td>
                                                <span class="badge bg-success" th:if="${entry.isRunning}">‚úì</span>
                                                <span class="badge bg-danger" th:unless="${entry.isRunning}">‚úó</span>
                                            </td>
                                            <td>
                                                <span class="badge bg-success" th:if="${entry.isHttpReachable == true}">‚úì</span>
                                                <span class="badge bg-danger" th:if="${entry.isHttpReachable == false}">‚úó</span>
                                                <span class="badge bg-secondary"
                                                      th:if="${entry.isHttpReachable == null}">-</span>
                                            </td>
                                            <td>
                                                <span class="badge bg-success"
                                                      th:if="${entry.isHttpsReachable == true}">‚úì</span>
                                                <span class="badge bg-danger"
                                                      th:if="${entry.isHttpsReachable == false}">‚úó</span>
                                                <span class="badge bg-secondary"
                                                      th:if="${entry.isHttpsReachable == null}">-</span>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Libs JS -->
<script src="/dist/js/tabler.min.js?1692870487" defer></script>
</body>
</html>
